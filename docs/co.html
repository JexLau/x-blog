<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>
      çºªå¹´ |ã€ç¬¬å››æœŸã€‘æµ…æ co æºç  | çºªå¹´
    </title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/blog/_assets/style.282607dd.css">
    <link rel="modulepreload" href="/blog/_assets/common-bec3f312.js">
    <link rel="modulepreload" href="/blog/_assets/docs_co.md.087aba0c.lean.js">
    <link rel="modulepreload" href="/blog/_assets/app.c2a4d5fc.js">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="keywords" content="çºªå¹´">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.css">
    <script src="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.js"></script>
    <script src="https://lib.baomitu.com/axios/0.21.1/axios.js"></script>
    
  </head>
  <body>
    <div id="app"><!--[--><div id="containerColor" class="no-sidebar theme" data-v-1880a9f7><header class="navbar" data-v-1880a9f7><!--[--><a class="title" aria-label="çºªå¹´, back to home" href="/blog/"><img class="logo" src="/blog/favicon.ico" alt="logo"><span>çºªå¹´</span></a><div class="flex-grow"></div><nav class="nav-links hide-mobile" data-v-1880a9f7><!--[--><!--[--><div class="nav-item" data-v-1880a9f7><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-1880a9f7><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-1880a9f7><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-1880a9f7><a class="nav-link" href="/blog/more/Friendship.html" target="" rel="">ğŸ‘« å‹æƒ…é“¾æ¥ <!----></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--[--><!--]--><!--]--><!--]--><div class="sidebar-button" data-v-1880a9f7><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div></header><aside class="" data-v-1880a9f7><!--[--><nav class="nav-links show-mobile" data-v-1880a9f7><!--[--><!--[--><div class="nav-item" data-v-1880a9f7><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-1880a9f7><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-1880a9f7><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--[--><div class="nav-item" data-v-1880a9f7><a class="nav-link" href="/blog/more/Friendship.html" target="" rel="">ğŸ‘« å‹æƒ…é“¾æ¥ <!----></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--[--><!--]--><!--]--><ul class="sidebar"><!--[--><!--]--></ul><!--[--><!--[--><!--]--><!--]--><!--]--></aside><!----><!-- TODO: make this button accessible --><div class="sidebar-mask" data-v-1880a9f7></div><main data-v-1880a9f7><!--[--><div class="content"><!--[--><!--[--><!--]--><!--]--><div class="md-header"><div class="md-title">çºªå¹´ |ã€ç¬¬å››æœŸã€‘æµ…æ co æºç </div><span id="jinrishici-sentence">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯....</span><div class="md-date">2021-09-02</div></div><ul class="catalog"><!--[--><li class="catalog-item"><a class="level level-2" href="#_1-å‰è¨€">1. å‰è¨€</a><!----></li><li class="catalog-item"><a class="level level-2" href="#_2-ç®€å•äº†è§£-co">2. ç®€å•äº†è§£ co</a><!----></li><li class="catalog-item"><!----><a class="level level-3" href="#_2-1-å…³äº-generator">2.1 å…³äº generator</a></li><li class="catalog-item"><a class="level level-2" href="#_3-å­¦ä¹ ç›®æ ‡">3. å­¦ä¹ ç›®æ ‡</a><!----></li><li class="catalog-item"><a class="level level-2" href="#_4-è§£è¯»-co-æºç ">4. è§£è¯» co æºç </a><!----></li><li class="catalog-item"><!----><a class="level level-3" href="#_4-1-æ•´ä½“æ¶æ„">4.1 æ•´ä½“æ¶æ„</a></li><li class="catalog-item"><!----><a class="level level-3" href="#_4-2-åˆ†æ-next-å‡½æ•°">4.2 åˆ†æ next å‡½æ•°</a></li><li class="catalog-item"><a class="level level-2" href="#_5-å®è·µ">5. å®è·µ</a><!----></li><li class="catalog-item"><!----><a class="level level-3" href="#_5-1-æ¨¡æ‹Ÿè¯·æ±‚">5.1 æ¨¡æ‹Ÿè¯·æ±‚</a></li><li class="catalog-item"><!----><a class="level level-3" href="#_5-2-æ¨¡æ‹Ÿå®ç°ç®€ç‰ˆ-co">5.2 æ¨¡æ‹Ÿå®ç°ç®€ç‰ˆ co</a></li><li class="catalog-item"><a class="level level-2" href="#_6-æ„Ÿæƒ³">6. æ„Ÿæƒ³</a><!----></li><!--]--></ul><div data-v-1880a9f7><blockquote><p>ã€è‹¥å·ã€‘æµ…æ koa æ´‹è‘±æ¨¡å‹å’Œ co åŸç†ï¼š<a href="https://juejin.cn/post/6844904088220467213" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6844904088220467213</a></p><p>ã€æ˜æµ·Zzzzã€‘co æºç è§£æï¼š<a href="https://juejin.cn/post/6844903472362422286" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6844903472362422286</a></p><p>ã€éªã€‘ co åº“æºç ï¼š<a href="https://www.yuque.com/ruochuan12/dxsvhs/pgzu2c" target="_blank" rel="noopener noreferrer">https://www.yuque.com/ruochuan12/dxsvhs/pgzu2c</a></p></blockquote><h2 id="_1-å‰è¨€"><a class="header-anchor" href="#_1-å‰è¨€" aria-hidden="true">#</a> 1. å‰è¨€</h2><p>è¿™å‘¨çœ‹çš„æ˜¯ co çš„æºç ï¼Œæˆ‘å¯¹ co æ¯”è¾ƒé™Œç”Ÿï¼Œæ²¡æœ‰äº†è§£å’Œä½¿ç”¨è¿‡ã€‚å› æ­¤åœ¨çœ‹æºç ä¹‹å‰ï¼Œæˆ‘å¸Œæœ›èƒ½å¤§æ¦‚äº†è§£ co æ˜¯ä»€ä¹ˆï¼Œè§£å†³äº†ä»€ä¹ˆé—®é¢˜ã€‚</p><h2 id="_2-ç®€å•äº†è§£-co"><a class="header-anchor" href="#_2-ç®€å•äº†è§£-co" aria-hidden="true">#</a> 2. ç®€å•äº†è§£ co</h2><p>å…ˆçœ‹äº† co çš„ <a href="https://github.com/tj/co" target="_blank" rel="noopener noreferrer">GitHub</a>ï¼ŒREADME æ˜¯è¿™æ ·ä»‹ç»çš„ï¼š</p><blockquote><p>Generator based control flow goodness for nodejs and the browser, using promises, letting you write non-blocking code in a nice-ish way.</p></blockquote><p>çœ‹èµ·æ¥æœ‰ç‚¹æ‡µé€¼ï¼ŒåˆæŸ¥äº†ä¸€äº›èµ„æ–™ï¼Œå¤§å¤šè¯´ co æ˜¯ç”¨äº generator å‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œã€‚generator æ˜¯ ES6 æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œå®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¯ä»¥æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œã€‚</p><h3 id="_2-1-å…³äº-generator"><a class="header-anchor" href="#_2-1-å…³äº-generator" aria-hidden="true">#</a> 2.1 å…³äº generator</h3><p>è¯´åˆ°å¼‚æ­¥ç¼–ç¨‹ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°è¿˜æœ‰ promiseï¼Œasync å’Œ awaitã€‚å®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿå…ˆçœ‹çœ‹ JS å¼‚æ­¥ç¼–ç¨‹è¿›åŒ–å²ï¼šcallback -&gt; promise -&gt; generator -&gt; async + await</p><p><img src="/blog/_assets/co0.28e8c460.png" alt="JS å¼‚æ­¥ç¼–ç¨‹"></p><p>å†çœ‹çœ‹å®ƒä»¬è¯­æ³•ä¸Šçš„å·®å¼‚ï¼š</p><table><thead><tr><th>Callback</th><th>Promise</th><th>Generator</th><th>async + await + Promise</th></tr></thead><tbody><tr><td>ajax(url, () =&gt; {})</td><td>Promise((resolve,reject) =&gt; { resolve() }).then()</td><td>function* gen() { yield 1}</td><td>async getData() { await fetchData() }</td></tr></tbody></table><blockquote><p>å…³äº generator çš„å­¦ä¹ ä¸åœ¨æ­¤ç¯‡å¹…è¯¦å†™äº†ï¼Œéœ€è¦äº†è§£å®ƒçš„æ¦‚å¿µå’Œè¯­æ³•ã€‚</p></blockquote><h2 id="_3-å­¦ä¹ ç›®æ ‡"><a class="header-anchor" href="#_3-å­¦ä¹ ç›®æ ‡" aria-hidden="true">#</a> 3. å­¦ä¹ ç›®æ ‡</h2><p>ç»è¿‡ç®€å•å­¦ä¹ ï¼Œå¤§æ¦‚æ˜ç™½äº† co äº§ç”Ÿçš„èƒŒæ™¯ï¼Œå› ä¸º generator å‡½æ•°ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨å®ƒçš„ next() å‡½æ•°ï¼Œco çš„ä½œç”¨å°±æ˜¯è‡ªåŠ¨æ‰§è¡Œ generator çš„ next() å‡½æ•°ï¼Œç›´åˆ° done çš„çŠ¶æ€å˜æˆ true ä¸ºæ­¢ã€‚</p><p>é‚£ä¹ˆæˆ‘è¿™ä¸€æœŸçš„å­¦ä¹ ç›®æ ‡ï¼š</p><p>1ï¼‰è§£è¯» co æºç ï¼Œç†è§£å®ƒæ˜¯å¦‚ä½•å®ç°è‡ªåŠ¨æ‰§è¡Œ generator</p><p>2ï¼‰åŠ¨æ‰‹å®ç°ä¸€ä¸ªç®€ç•¥ç‰ˆçš„ co</p><h2 id="_4-è§£è¯»-co-æºç "><a class="header-anchor" href="#_4-è§£è¯»-co-æºç " aria-hidden="true">#</a> 4. è§£è¯» co æºç </h2><p>co æºç åœ°å€ï¼š<a href="https://github.com/tj/co" target="_blank" rel="noopener noreferrer">https://github.com/tj/co</a></p><h3 id="_4-1-æ•´ä½“æ¶æ„"><a class="header-anchor" href="#_4-1-æ•´ä½“æ¶æ„" aria-hidden="true">#</a> 4.1 æ•´ä½“æ¶æ„</h3><p>ä» README ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯å¦‚ä½•ä½¿ç”¨ co ï¼š</p><div class="language-javascript"><pre><code><span class="token function">co</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">yield</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>stack<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä»ä»£ç å¯ä»¥çœ‹åˆ°å®ƒæ¥æ”¶äº†ä¸€ä¸ª generator å‡½æ•°ï¼Œè¿”å›äº†ä¸€ä¸ª Promiseï¼Œè¿™éƒ¨åˆ†å¯¹åº”çš„æºç å¦‚ä¸‹ã€‚</p><div class="language-javascript"><pre><code><span class="token keyword">function</span> <span class="token function">co</span><span class="token punctuation">(</span><span class="token parameter">gen</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token comment">// è·å–å‚æ•°</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è¿”å›ä¸€ä¸ª Promise</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æŠŠ ctx å’Œå‚æ•°ä¼ é€’ç»™ gen å‡½æ•°</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> gen <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> gen <span class="token operator">=</span> <span class="token function">gen</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆ¤æ–­ gen.next æ˜¯å¦å‡½æ•°ï¼Œå¦‚æœä¸æ˜¯ç›´æ¥ resolve(gen)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gen <span class="token operator">||</span> <span class="token keyword">typeof</span> gen<span class="token punctuation">.</span>next <span class="token operator">!==</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å…ˆæ‰§è¡Œä¸€æ¬¡ next</span>
    <span class="token function">onFulfilled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å®é™…ä¸Šå°±æ˜¯æ‰§è¡Œ gen.next å‡½æ•°ï¼Œè·å– gen çš„å€¼</span>
    <span class="token keyword">function</span> <span class="token function">onFulfilled</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> ret<span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        ret <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">next</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¯¹ gen.throw çš„å¤„ç†</span>
    <span class="token keyword">function</span> <span class="token function">onRejected</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> ret<span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        ret <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">next</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å®é™…å¤„ç†çš„å‡½æ•°ï¼Œä¼šé€’å½’æ‰§è¡Œï¼Œç›´åˆ° ret.done çŠ¶æ€ä¸º true</span>
    <span class="token keyword">function</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">ret</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœç”Ÿæˆå™¨çš„çŠ¶æ€ done ä¸º trueï¼Œå°± resolve(ret.value)ï¼Œè¿”å›ç»“æœ</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å¦åˆ™ï¼Œå°† gen çš„ç»“æœ value å°è£…æˆ Promise</span>
      <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token function">toPromise</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> ret<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// åˆ¤æ–­ value æ˜¯å¦ Promiseï¼Œå¦‚æœæ˜¯å°±è¿”å› then</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&amp;&amp;</span> <span class="token function">isPromise</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å¦‚æœä¸æ˜¯ Promiseï¼ŒRejected</span>
      <span class="token keyword">return</span> <span class="token function">onRejected</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">&#39;You may only yield a function, promise, generator, array, or object, &#39;</span>
        <span class="token operator">+</span> <span class="token string">&#39;but the following object was passed: &quot;&#39;</span> <span class="token operator">+</span> <span class="token function">String</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘äº§ç”Ÿäº†ä¸€ä¸ªç–‘é—®ï¼šPromise + then ä¹Ÿå¯ä»¥å¤„ç†å¼‚æ­¥ç¼–ç¨‹ï¼Œä¸ºä»€ä¹ˆ co çš„æºç é‡Œè¦æŠŠ Promise + generator ç»“åˆèµ·æ¥å‘¢ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿç›´åˆ°æˆ‘ææ‡‚äº† co çš„æ ¸å¿ƒç›®çš„ï¼Œå®ƒä½¿ generator å’Œ yield çš„è¯­æ³•æ›´è¶‹å‘äºåŒæ­¥ç¼–ç¨‹çš„å†™æ³•ï¼Œå¼•ç”¨<a href="https://www.ruanyifeng.com/blog/2015/04/generator.html" target="_blank" rel="noopener noreferrer">é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a>ä¸­çš„ä¸€å¥è¯å°±æ˜¯ï¼š</p><blockquote><p>å¼‚æ­¥ç¼–ç¨‹çš„è¯­æ³•ç›®æ ‡ï¼Œå°±æ˜¯æ€æ ·è®©å®ƒæ›´åƒåŒæ­¥ç¼–ç¨‹ã€‚</p></blockquote><p>å¯ä»¥çœ‹ä¸€ä¸ª Promise + then çš„ä¾‹å­ï¼š</p><div class="language-javascript"><pre><code><span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1111</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¤„ç†ç¬¬ä¸€ä¸ªå¼‚æ­¥çš„ç»“æœ</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è¿”å›ç¬¬äºŒä¸ªå¼‚æ­¥</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2222</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¤„ç†ç¬¬äºŒä¸ªå¼‚æ­¥çš„ç»“æœ</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¦‚æœæœ‰å¤šä¸ªå¼‚æ­¥å¤„ç†å°±ä¼šéœ€è¦å†™å¤šå°‘ä¸ª then æ¥å¤„ç†å¼‚æ­¥ä¹‹é—´å¯èƒ½å­˜åœ¨çš„åŒæ­¥å…³ç³»ï¼Œä»ä»¥ä¸Šçš„ä»£ç å¯ä»¥çœ‹åˆ° then çš„å¤„ç†æ˜¯ä¸€å±‚ä¸€å±‚çš„åµŒå¥—ã€‚å¦‚æœæ¢æˆ coï¼Œåœ¨å†™æ³•ä¸Šæ›´ä¼˜é›…ä¹Ÿ<strong>æ›´ç¬¦åˆæ—¥å¸¸åŒæ­¥ç¼–ç¨‹</strong>çš„å†™æ³•ï¼š</p><div class="language-javascript"><pre><code><span class="token function">co</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> result1 <span class="token operator">=</span> <span class="token keyword">yield</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1111</span><span class="token punctuation">)</span>
    <span class="token comment">// å¤„ç†ç¬¬ä¸€ä¸ªå¼‚æ­¥çš„ç»“æœ</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è¿”å›ç¬¬äºŒä¸ªå¼‚æ­¥</span>
    <span class="token keyword">var</span> result2 <span class="token operator">=</span> <span class="token keyword">yield</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2222</span><span class="token punctuation">)</span>
    <span class="token comment">// å¤„ç†ç¬¬äºŒä¸ªå¼‚æ­¥çš„ç»“æœ</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result2<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-2-åˆ†æ-next-å‡½æ•°"><a class="header-anchor" href="#_4-2-åˆ†æ-next-å‡½æ•°" aria-hidden="true">#</a> 4.2 åˆ†æ next å‡½æ•°</h3><p>æºç çš„ next å‡½æ•°æ¥æ”¶ä¸€ä¸ª gen.next() è¿”å›çš„å¯¹è±¡ ret ä½œä¸ºå‚æ•°ï¼Œå½¢å¦‚<code>{value: T, done: boolean}</code>ï¼Œnext å‡½æ•°åªæœ‰å››è¡Œä»£ç ã€‚</p><p>ç¬¬ä¸€è¡Œï¼š<code>if (ret.done) return resolve(ret.value);</code> å¦‚æœ ret.done ä¸º trueï¼Œè¡¨æ˜ gen å‡½æ•°åˆ°äº†ç»“æŸçŠ¶æ€ï¼Œå°± resolve(ret.value)ï¼Œè¿”å›ç»“æœã€‚</p><p>ç¬¬äºŒè¡Œï¼š<code>var value = toPromise.call(ctx, ret.value);</code> è°ƒç”¨ toPromise.call(ctx, ret.value) å‡½æ•°ï¼ŒtoPromise å‡½æ•°çš„ä½œç”¨æ˜¯æŠŠ ret.value è½¬åŒ–æˆ Promise ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ç”¨ Promise åŒ…è£¹ä¸€å±‚å† return å‡ºå»ã€‚</p><div class="language-javascript"><pre><code><span class="token keyword">function</span> <span class="token function">toPromise</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¦‚æœ obj ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å› obj</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token comment">// å¦‚æœ obj æ˜¯ Promise ç±»å‹ï¼Œç›´æ¥è¿”å› obj</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPromise</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token comment">// å¦‚æœ obj æ˜¯ç”Ÿæˆå™¨å‡½æ•°æˆ–éå†å™¨å¯¹è±¡, å°±é€’å½’è°ƒç”¨ co å‡½æ•°</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isGeneratorFunction</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isGenerator</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">co</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å¦‚æœ obj æ˜¯æ™®é€šçš„å‡½æ•°ç±»å‹ï¼Œè½¬æ¢æˆ Promise ç±»å‹å‡½æ•°å†è¿”å›</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;function&#39;</span> <span class="token operator">==</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">thunkToPromise</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å¦‚æœ obj æ˜¯ä¸€ä¸ªæ•°ç»„, è½¬æ¢æˆ Promise æ•°ç»„å†è¿”å›</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">arrayToPromise</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å¦‚æœ obj æ˜¯ä¸€ä¸ªå¯¹è±¡, è½¬æ¢æˆ Promise å¯¹è±¡å†è¿”å›</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">objectToPromise</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å…¶ä»–æƒ…å†µç›´æ¥è¿”å›</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç¬¬ä¸‰è¡Œï¼š<code>if (value &amp;&amp; isPromise(value)) return value.then(onFulfilled, onRejected);</code> å¦‚æœ value æ˜¯ Promise ç±»å‹ï¼Œè°ƒç”¨ onFulfilled æˆ– onRejectedï¼Œå®é™…ä¸Šæ˜¯é€’å½’è°ƒç”¨äº† next å‡½æ•°æœ¬èº«ï¼Œç›´åˆ° done çŠ¶æ€ä¸º true æˆ– throw errorã€‚</p><p>ç¬¬å››è¡Œï¼š<code>return onRejected(...)</code> å¦‚æœä¸æ˜¯ Promiseï¼Œç›´æ¥ Rejectedã€‚</p><h2 id="_5-å®è·µ"><a class="header-anchor" href="#_5-å®è·µ" aria-hidden="true">#</a> 5. å®è·µ</h2><p>è™½ç„¶è§£è¯»äº† co çš„æ ¸å¿ƒä»£ç ï¼Œçœ‹èµ·æ¥åƒæ˜¯æ‡‚äº†ï¼Œå®é™…ä¸Šå¾ˆå®¹æ˜“é—å¿˜ã€‚ä¸ºäº†åŠ æ·±ç†è§£ï¼Œç»“åˆä¸Šé¢çš„ co æºç å’Œè‡ªå·±çš„æ€è·¯åŠ¨æ‰‹å®ç°ä¸€ä¸ªç®€ç•¥ç‰ˆçš„ coã€‚</p><h3 id="_5-1-æ¨¡æ‹Ÿè¯·æ±‚"><a class="header-anchor" href="#_5-1-æ¨¡æ‹Ÿè¯·æ±‚" aria-hidden="true">#</a> 5.1 æ¨¡æ‹Ÿè¯·æ±‚</h3><div class="language-javascript"><pre><code><span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>data<span class="token operator">:</span> <span class="token string">&#39;request&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ç”¨ yield è·å– request çš„å€¼</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> g <span class="token operator">=</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> <span class="token punctuation">{</span>value<span class="token punctuation">,</span> done<span class="token punctuation">}</span> <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// é—´éš”1såæ‰“å° {data: &quot;request&quot;}</span>
value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_5-2-æ¨¡æ‹Ÿå®ç°ç®€ç‰ˆ-co"><a class="header-anchor" href="#_5-2-æ¨¡æ‹Ÿå®ç°ç®€ç‰ˆ-co" aria-hidden="true">#</a> 5.2 æ¨¡æ‹Ÿå®ç°ç®€ç‰ˆ co</h3><p>æ ¸å¿ƒå®ç°ï¼š</p><p>1ï¼‰å‡½æ•°ä¼ å‚</p><p>2ï¼‰generator.next è‡ªåŠ¨æ‰§è¡Œ</p><div class="language-javascript"><pre><code><span class="token keyword">function</span> <span class="token function">co</span><span class="token punctuation">(</span><span class="token parameter">gen</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. ä¼ å‚</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gen <span class="token operator">=</span> <span class="token function">gen</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2. è‡ªåŠ¨æ‰§è¡Œ next</span>
    <span class="token function">onFulfilled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">function</span> <span class="token function">onFulfilled</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> ret <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">next</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">function</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">ret</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>ret<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>ret<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// æ­¤å¤„åªå¤„ç† ret.value æ˜¯ Promise å¯¹è±¡çš„æƒ…å†µï¼Œå…¶ä»–ç±»å‹ç®€ç•¥ç‰ˆæ²¡å¤„ç†</span>
      <span class="token keyword">var</span> promise <span class="token operator">=</span> ret<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
      <span class="token comment">// è‡ªåŠ¨æ‰§è¡Œ</span>
      promise <span class="token operator">&amp;&amp;</span> promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>onFulfilled<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ‰§è¡Œ</span>
<span class="token function">co</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 1såæ‰“å° {data: &quot;request&quot;}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_6-æ„Ÿæƒ³"><a class="header-anchor" href="#_6-æ„Ÿæƒ³" aria-hidden="true">#</a> 6. æ„Ÿæƒ³</h2><p>å¯¹æˆ‘æ¥è¯´ï¼Œå­¦ä¹ ä¸€ä¸ªæ–°çš„ä¸œè¥¿ï¼ˆgeneratorï¼‰èŠ±è´¹çš„æ—¶é—´è¿œè¿œå¤§äºå•çº¯é˜…è¯»æºç çš„æ—¶é—´ï¼Œå› ä¸ºéœ€è¦äº†è§£å®ƒäº§ç”Ÿçš„èƒŒæ™¯ï¼Œè¯­æ³•ï¼Œè§£å†³çš„é—®é¢˜ä»¥åŠä¸€äº›åº”ç”¨åœºæ™¯ï¼Œè¿™æ ·åœ¨é˜…è¯»æºç çš„æ—¶å€™æ‰çŸ¥é“å®ƒä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ã€‚</p><p>è¯»å®Œæºç ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå…¶å® co å°±æ˜¯ä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œ next() çš„å‡½æ•°ï¼Œè€Œä¸”åˆ°æœ€åæˆ‘ä»¬ä¼šå‘ç° co çš„å†™æ³•å’Œæˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„ async/await çš„å†™æ³•éå¸¸ç›¸åƒï¼Œå› æ­¤ä¹Ÿä¸éš¾ç†è§£ã€async/await å®é™…ä¸Šæ˜¯å¯¹ generator å°è£…çš„ä¸€ä¸ªè¯­æ³•ç³–ã€‘è¿™å¥è¯äº†ã€‚</p><div class="language-javascript"><pre><code><span class="token comment">// co å†™æ³•</span>
<span class="token function">co</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 1såæ‰“å° {data: &quot;request&quot;}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// async await å†™æ³•</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 1såæ‰“å° {data: &quot;request&quot;}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>ä¸å¾—ä¸è¯´ï¼Œé˜…è¯»æºç çš„ç¡®æ˜¯ä¸€ä¸ªå¼€é˜”è§†é‡çš„å¥½æ–¹æ³•ï¼Œå¦‚æœä¸æ˜¯è¿™æ¬¡æ´»åŠ¨ï¼Œæˆ‘å¯èƒ½è¿˜è¦æ™šä¸ªå¤§åŠå¹´æ‰æ¥è§¦åˆ° generatorï¼Œæ¥è§¦åç¨‹çš„æ¦‚å¿µï¼Œäº†è§£åˆ° async/await å®ç°çš„åŸç†ï¼Œå¸Œæœ›èƒ½å¤Ÿç»§ç»­åšæŒä¸‹å»~</p><div id="gitalk-container" data-v-1880a9f7></div></div><div class="links-wrapper" data-v-1880a9f7><div class="prev-link"><!----></div><div class="next-link"><!----></div></div><div data-v-1880a9f7><footer class="page-edit"><!--[--><a key="0" href="https://juejin.cn/user/3175045313607534"><img class="imgIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC"></a><!--]--></footer><p class="platform"> ä»¥ä¸Šçš†ä¸º <a href="javascript:;">çºªå¹´</a> æ–‡ç« å‘å¸ƒå¹³å° </p><p class="platform"> Copyright Â© 2020-2021 <a href="https://github.com/jexlau">@JexLau</a></p></div><!--[--><!--[--><!--]--><!--]--></div><!-- åªæƒ³ç‚¹å‡»èƒŒæ™¯æ‰å…³é—­ è¯·ä½¿ç”¨ .self ä¿®é¥°ç¬¦ --><div style="display:none;" class="imgBox"><img src=""></div><!--]--></main><div class="theme-select" data-v-1880a9f7><ul data-v-1880a9f7><li class="active" data-v-1880a9f7>â˜€ï¸</li><li class="" data-v-1880a9f7>ğŸŒ‘</li></ul></div></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"a49591c5\",\"README.md\":\"c858e745\",\"docs_co.md\":\"087aba0c\",\"docs_launch-editor.md\":\"7e6887da\",\"docs_vue3-release.md\":\"6c18248d\",\"docs_vue3-utils.md\":\"4d30142a\",\"more_docs.md\":\"4b1bb4bd\",\"more_Friendship.md\":\"a5324780\",\"more_index.md\":\"253ee8a1\",\"more_tags.md\":\"004183e3\"}")</script>
    <script type="module" async src="/blog/_assets/app.c2a4d5fc.js"></script>
  </body>
</html>